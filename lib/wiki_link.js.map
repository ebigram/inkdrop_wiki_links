{"version":3,"sources":["../src/wiki_link.js"],"names":["db","inkdrop","main","dataStore","getLocalDB","createRemarkWikiLink","OriginalAnchor","WikiLink","React","Component","render","link","props","children","attributes","className","onClick","utils","search","then","note","docs","length","commands","dispatch","document","body","noteId","_id","editingNote","store","getState","notes","put","createId","title","createdAt","Date","now","updatedAt","renderError","error","message","e","PropTypes","arrayOf","string"],"mappings":";AAAA;;;;;;;AACA;;AACA;;;;;;;;;;AAEA,MAAMA,EAAE,GAAGC,OAAO,CAACC,IAAR,CAAaC,SAAb,CAAuBC,UAAvB,EAAX;;AAEA,MAAMC,oBAAoB,GAAIC,cAAD,IAAoB;AAAA;;AAC7C,0BAAO,MAAMC,QAAN,SAAuBC,KAAK,CAACC,SAA7B,CAAuC;AAK1CC,IAAAA,MAAM,GAAG;AACL,YAAMC,IAAI,GAAG,KAAKC,KAAL,CAAWC,QAAX,CAAoB,CAApB,CAAb;;AACA,UAAIF,IAAJ,EAAU;AACN,YAAI;AACA,gBAAMG,UAAU,GAAG;AACfC,YAAAA,SAAS,EAAE,WADI;AAEfC,YAAAA,OAAO,EAAE,MAAM;AACXhB,cAAAA,EAAE,CAACiB,KAAH,CAASC,MAAT,CAAiB,SAAQP,IAAK,EAA9B,EAAiCQ,IAAjC,CAAuCC,IAAD,IAAU;AAC5C,oBAAIA,IAAI,SAAJ,IAAAA,IAAI,WAAJ,IAAAA,IAAI,CAAEC,IAAN,IAAcD,IAAI,CAACC,IAAL,CAAUC,MAAV,GAAmB,CAArC,EAAwC;AACpCrB,kBAAAA,OAAO,CAACsB,QAAR,CAAiBC,QAAjB,CACIC,QAAQ,CAACC,IADb,EAEI,gBAFJ,EAGI;AAAEC,oBAAAA,MAAM,EAAEP,IAAI,CAACC,IAAL,CAAU,CAAV,EAAaO;AAAvB,mBAHJ;AAKH,iBAND,MAMO;AACH,wBAAM;AACFC,oBAAAA;AADE,sBAEF5B,OAAO,CAAC6B,KAAR,CAAcC,QAAd,EAFJ;AAGA;AACA/B,kBAAAA,EAAE,CAACgC,KAAH,CAASC,GAAT,CAAa,EACT,GAAGJ,WADM;AAETD,oBAAAA,GAAG,EAAE5B,EAAE,CAACgC,KAAH,CAASE,QAAT,EAFI;AAGTR,oBAAAA,IAAI,EAAE,EAHG;AAITS,oBAAAA,KAAK,EAAExB,IAJE;AAKTyB,oBAAAA,SAAS,EAAEC,IAAI,CAACC,GAAL,EALF;AAMTC,oBAAAA,SAAS,EAAEF,IAAI,CAACC,GAAL;AANF,mBAAb;AAQH;AACJ,eArBD;AAsBH,aAzBc;AA0BfE,YAAAA,WAAW,EAAGC,KAAD,IAAW;AACpB,kCACI;AAAM,gBAAA,SAAS,EAAC;AAAhB,iBACKA,KAAK,CAACC,OADX,CADJ;AAKH;AAhCc,WAAnB;;AAkCA,cAAIpC,cAAJ,EAAoB;AAChB,gCACI,oBAAC,cAAD,EAAoBQ,UAApB,EACKH,IADL,CADJ;AAKH,WAND,MAMO;AACH,gCAAO,yBAAOG,UAAP,EAAoBH,IAApB,CAAP;AACH;AACJ,SA5CD,CA4CE,OAAOgC,CAAP,EAAU;AACR,8BAAO,kCAAOA,CAAC,CAACD,OAAT,CAAP;AACH;AACJ,OAhDD,MAgDO;AACH,4BAAO,sDAAP;AACH;AACJ;;AA1DyC,GAA9C,uCACuB;AACf7B,IAAAA,QAAQ,EAAE+B,mBAAUC,OAAV,CAAkBD,mBAAUE,MAA5B;AADK,GADvB;AA4DH,CA7DD;;eA+DezC,oB","sourcesContent":["\"use babel\";\nimport * as React from \"react\";\nimport PropTypes from \"prop-types\";\n\nconst db = inkdrop.main.dataStore.getLocalDB();\n\nconst createRemarkWikiLink = (OriginalAnchor) => {\n    return class WikiLink extends React.Component {\n        static propTypes = {\n            children: PropTypes.arrayOf(PropTypes.string),\n        };\n\n        render() {\n            const link = this.props.children[0];\n            if (link) {\n                try {\n                    const attributes = {\n                        className: \"wiki_link\",\n                        onClick: () => {\n                            db.utils.search(`title:${link}`).then((note) => {\n                                if (note?.docs && note.docs.length > 0) {\n                                    inkdrop.commands.dispatch(\n                                        document.body,\n                                        \"core:open-note\",\n                                        { noteId: note.docs[0]._id }\n                                    );\n                                } else {\n                                    const {\n                                        editingNote,\n                                    } = inkdrop.store.getState();\n                                    debugger;\n                                    db.notes.put({\n                                        ...editingNote,\n                                        _id: db.notes.createId(),\n                                        body: \"\",\n                                        title: link,\n                                        createdAt: Date.now(),\n                                        updatedAt: Date.now(),\n                                    });\n                                }\n                            });\n                        },\n                        renderError: (error) => {\n                            return (\n                                <span className=\"ui error message mde-error-message\">\n                                    {error.message}\n                                </span>\n                            );\n                        },\n                    };\n                    if (OriginalAnchor) {\n                        return (\n                            <OriginalAnchor {...attributes}>\n                                {link}\n                            </OriginalAnchor>\n                        );\n                    } else {\n                        return <a {...attributes}>{link}</a>;\n                    }\n                } catch (e) {\n                    return <span>{e.message}</span>;\n                }\n            } else {\n                return <span>Invalid Wiki Link</span>;\n            }\n        }\n    };\n};\n\nexport default createRemarkWikiLink;\n"],"file":"wiki_link.js"}