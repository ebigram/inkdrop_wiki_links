{"version":3,"sources":["../src/index.js"],"names":["module","exports","originalSpanComponent","setWikiLinkComponent","OriginalSpan","markdownRenderer","remarkReactComponents","span","WikiLink","unsetWikiLinkComponent","activate","remarkPlugins","push","wikiLinkPlugin","inkdrop","isMobile","global","onEditorLoad","editor","handleEditorDidLoad","deactivate","filter","plugin","activeEditor","getActiveEditorOrThrowError","textcompleteEditor","CodeMirrorEditor","cm","textcomplete","Textcomplete","strategy","option"],"mappings":";;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;AACA;;;;AAPA;AASAA,MAAM,CAACC,OAAP,GAAiB;AACbC,EAAAA,qBAAqB,EAAE,IADV;;AAEbC,EAAAA,oBAAoB,GAAG;AACnB,UAAMC,YAAY,GAAGC,0BAAiBC,qBAAjB,CAAuCC,IAA5D;AACA,UAAMC,QAAQ,GAAG,wBAAqBJ,YAArB,CAAjB;AACAC,8BAAiBC,qBAAjB,CAAuCC,IAAvC,GAA8CC,QAA9C;AACA,SAAKN,qBAAL,GAA6BE,YAA7B;AACH,GAPY;;AASbK,EAAAA,sBAAsB,GAAG;AACrBJ,8BAAiBC,qBAAjB,CAAuCC,IAAvC,GAA8C,KAAKL,qBAAnD;AACH,GAXY;;AAYbQ,EAAAA,QAAQ,GAAG;AACP,QAAIL,yBAAJ,EAAsB;AAClBA,gCAAiBM,aAAjB,CAA+BC,IAA/B,CAAoCC,yBAApC;;AACA,UAAI,CAACC,OAAO,CAACC,QAAb,EAAuB;AACnB,aAAKZ,oBAAL;AACH;AACJ;;AACDa,IAAAA,MAAM,CAACF,OAAP,CAAeG,YAAf,CAA6BC,MAAD,IACxB,KAAKC,mBAAL,CAAyBD,MAAzB,CADJ;AAGH,GAtBY;;AAwBbE,EAAAA,UAAU,GAAG;AACT,QAAIf,yBAAJ,EAAsB;AAClBA,gCAAiBM,aAAjB,GAAiCN,0BAAiBM,aAAjB,CAA+BU,MAA/B,CAC5BC,MAAD,IAAYA,MAAM,KAAKT,yBADM,CAAjC;;AAGA,UAAI,CAACC,OAAO,CAACC,QAAb,EAAuB;AACnB,aAAKN,sBAAL;AACH;AACJ;AACJ,GAjCY;;AAkCb;AACAU,EAAAA,mBAAmB,GAAG;AAClB;AACA,UAAMI,YAAY,GAAGT,OAAO,CAACU,2BAAR,EAArB,CAFkB,CAGlB;AACA;AACA;AACA;AACA;AAEA;;AACA,UAAMC,kBAAkB,GAAG,IAAIC,4BAAJ,CAAqBH,YAAY,CAACI,EAAlC,CAA3B,CAVkB,CAWlB;;AACA,UAAMC,YAAY,GAAG,IAAIC,kBAAJ,CACjBJ,kBADiB,EAEjB,CAACK,0BAAD,CAFiB,EAGjBC,wBAHiB,CAArB;AAKH;;AApDY,CAAjB","sourcesContent":["/*global codeMirror*/\nimport { markdownRenderer } from \"inkdrop\";\nimport createRemarkWikiLink from \"./wiki_link\";\nimport wikiLinkPlugin from \"./wiki_link_plugin\";\nimport { Textcomplete } from \"@textcomplete/core\";\nimport { CodeMirrorEditor } from \"@textcomplete/codemirror\";\nimport { strategy, option } from \"./wiki_completions\";\nimport CodeMirror from \"codemirror\";\n\nmodule.exports = {\n    originalSpanComponent: null,\n    setWikiLinkComponent() {\n        const OriginalSpan = markdownRenderer.remarkReactComponents.span;\n        const WikiLink = createRemarkWikiLink(OriginalSpan);\n        markdownRenderer.remarkReactComponents.span = WikiLink;\n        this.originalSpanComponent = OriginalSpan;\n    },\n\n    unsetWikiLinkComponent() {\n        markdownRenderer.remarkReactComponents.span = this.originalSpanComponent;\n    },\n    activate() {\n        if (markdownRenderer) {\n            markdownRenderer.remarkPlugins.push(wikiLinkPlugin);\n            if (!inkdrop.isMobile) {\n                this.setWikiLinkComponent();\n            }\n        }\n        global.inkdrop.onEditorLoad((editor) =>\n            this.handleEditorDidLoad(editor)\n        );\n    },\n\n    deactivate() {\n        if (markdownRenderer) {\n            markdownRenderer.remarkPlugins = markdownRenderer.remarkPlugins.filter(\n                (plugin) => plugin !== wikiLinkPlugin\n            );\n            if (!inkdrop.isMobile) {\n                this.unsetWikiLinkComponent();\n            }\n        }\n    },\n    /** @param {CodeMirror.Editor} editor  **/\n    handleEditorDidLoad() {\n        // const { cm } = editor;\n        const activeEditor = inkdrop.getActiveEditorOrThrowError();\n        // cm.foobar = 1;\n        // otherThing.foobar = 2;\n        // debugger;\n        //const cm = CodeMirror(document.getElementById('editor'))\n        // debugger;\n\n        //cm.on(document.body,\"beforeChange\", (e)=>{e.preventDefault(); e.stopPropagation(); CodeMirror.Pass});\n        const textcompleteEditor = new CodeMirrorEditor(activeEditor.cm);\n        // const textcompleteEditor = new CodeMirrorEditor(activeEditor.cm);\n        const textcomplete = new Textcomplete(\n            textcompleteEditor,\n            [strategy],\n            option\n        );\n    },\n};\n"],"file":"index.js"}